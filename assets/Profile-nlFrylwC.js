import{c as D,r as p,d as w,j as e}from"./index-BlDSkOmT.js";const T={"workflow-automation":"#0078d4","data-processing":"#6f42c1","security-services":"#e83e8c","sales-marketing":"#fd7e14","quality-management":"#20c997","mobile-solutions":"#17a2b8",consultation:"#ffc107",implementation:"#6610f2",support:"#dc3545",training:"#28a745"};function M(r){const s=g=>g.toString().padStart(2,"0"),a=new Date(r.start),o=new Date(r.end),c=`${a.getUTCFullYear()}${s(a.getUTCMonth()+1)}${s(a.getUTCDate())}T${s(a.getUTCHours())}${s(a.getUTCMinutes())}00Z`,m=`${o.getUTCFullYear()}${s(o.getUTCMonth()+1)}${s(o.getUTCDate())}T${s(o.getUTCHours())}${s(o.getUTCMinutes())}00Z`;return`BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
SUMMARY:${r.title}
DTSTART:${c}
DTEND:${m}
DESCRIPTION:${r.description||""}
END:VEVENT
END:VCALENDAR`}function R({anchor:r,children:s,open:a,onClose:o}){if(!a||!r)return null;const c=r.getBoundingClientRect();return e.jsx("div",{style:{position:"fixed",top:c.bottom+6,left:c.left,zIndex:9999,background:"#fff",border:"1px solid #e0e0e0",borderRadius:8,boxShadow:"0 4px 16px rgba(0,0,0,0.12)",padding:16,minWidth:220},onMouseLeave:o,children:s})}function k({events:r}){const[s,a]=p.useState(()=>{const n=new Date;return new Date(n.getFullYear(),n.getMonth(),1)}),[o,c]=p.useState({anchor:null,event:null}),m=new Date,g=r.reduce((n,t)=>{const d=t.start.split("T")[0];return n[d]||(n[d]=[]),n[d].push(t),n},{}),i=s.getFullYear(),l=s.getMonth(),v=new Date(i,l+1,0).getDate(),f=new Date(i,l,1).getDay(),h=[];for(let n=0;n<f;n++)h.push(null);for(let n=1;n<=v;n++)h.push(new Date(i,l,n));for(;h.length%7!==0;)h.push(null);const j=()=>a(new Date(i,l-1,1)),b=()=>a(new Date(i,l+1,1)),y={minHeight:56,borderRadius:8,textAlign:"center",padding:4,position:"relative",transition:"background 0.2s, border 0.2s",cursor:"pointer",fontSize:15};return e.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:12,padding:20,marginBottom:24,background:"#fafbfc",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[e.jsx("button",{onClick:j,style:{background:"none",border:"none",fontSize:22,cursor:"pointer",color:"#0078d4"},"aria-label":"Previous Month",children:"‹"}),e.jsx("h3",{style:{margin:0,fontWeight:700,fontSize:20},children:s.toLocaleString("default",{month:"long",year:"numeric"})}),e.jsx("button",{onClick:b,style:{background:"none",border:"none",fontSize:22,cursor:"pointer",color:"#0078d4"},"aria-label":"Next Month",children:"›"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4,fontWeight:600,color:"#888",marginBottom:4},children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(n=>e.jsx("div",{style:{textAlign:"center"},children:n},n))}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4},children:h.map((n,t)=>{if(!n)return e.jsx("div",{style:{minHeight:56}},t);const d=n.toISOString().split("T")[0],u=n.toDateString()===m.toDateString(),x=g[d];return e.jsxs("div",{style:{...y,background:u?"#e3f1ff":x?"#eafbe7":"#fff",border:u?"2px solid #0078d4":x?"2px solid #28a745":"1px solid #e0e0e0",color:u?"#0078d4":x?"#155724":"#333",boxShadow:u?"0 0 0 2px #b3e0ff":void 0},children:[e.jsx("div",{style:{fontWeight:600},children:n.getDate()}),x&&e.jsx("div",{style:{marginTop:4},children:x.map(S=>e.jsx("div",{style:{background:T[S.title.split(" - ")[0].toLowerCase().replace(/ /g,"-")]||"#28a745",color:"#fff",borderRadius:6,fontSize:11,padding:"2px 6px",marginBottom:2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:80,marginLeft:"auto",marginRight:"auto",cursor:"pointer",border:"1px solid #fff",boxShadow:"0 1px 4px rgba(0,0,0,0.07)"},onClick:C=>c({anchor:C.target,event:S}),children:S.title},S.id))})]},d)})}),e.jsx(R,{anchor:o.anchor,open:!!o.event,onClose:()=>c({anchor:null,event:null}),children:o.event&&e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,marginBottom:4},children:o.event.title}),e.jsxs("div",{style:{color:"#555",marginBottom:4},children:[new Date(o.event.start).toLocaleDateString(),e.jsx("br",{}),new Date(o.event.start).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ",new Date(o.event.end).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),o.event.description&&e.jsx("div",{style:{marginBottom:4},children:o.event.description}),e.jsx("button",{style:{background:"#0078d4",color:"#fff",border:"none",borderRadius:6,padding:"6px 12px",fontWeight:600,cursor:"pointer",marginTop:6},onClick:()=>{const n=M(o.event),t=new Blob([n],{type:"text/calendar"}),d=URL.createObjectURL(t),u=document.createElement("a");u.href=d,u.download=`${o.event.title.replace(/\s+/g,"_")}.ics`,document.body.appendChild(u),u.click(),setTimeout(()=>{document.body.removeChild(u),URL.revokeObjectURL(d)},100)},children:"Add to Device Calendar"})]})})]})}function A(){const{user:r}=D(),[s,a]=p.useState([]),[o,c]=p.useState([]),[m,g]=p.useState(!1),[i,l]=p.useState({date:"",time:"",service:"",message:""}),[v,f]=p.useState(""),[h,j]=p.useState("");p.useEffect(()=>{b(),y()},[]);const b=async()=>{g(!0);try{const t=await w.request("/appointments/my-requests");c(t.appointmentRequests||[])}catch{c([])}finally{g(!1)}},y=async()=>{try{const t=await w.request("/appointments/calendar");a(t.calendarEvents||[])}catch{a([])}},n=async t=>{t.preventDefault(),g(!0),f(""),j("");try{await w.request("/appointments/request",{method:"POST",body:JSON.stringify({preferredDate:i.date,preferredTime:i.time,service:i.service,message:i.message})}),j("Appointment request sent! We will contact you to confirm."),l({date:"",time:"",service:"",message:""}),b(),y()}catch(d){f(d.message||"Failed to book appointment.")}finally{g(!1)}};return r?e.jsxs("div",{style:{maxWidth:700,margin:"40px auto",background:"#fff",borderRadius:16,boxShadow:"0 8px 32px rgba(0,0,0,0.08)",padding:32},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:24,marginBottom:32},children:[e.jsx("img",{src:r.avatarUrl||`https://ui-avatars.com/api/?name=${encodeURIComponent(r.name||r.email)}`,alt:"Avatar",style:{width:90,height:90,borderRadius:"50%",objectFit:"cover",border:"2px solid #eee"}}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0},children:r.name||r.displayName||"No Name"}),e.jsx("div",{style:{color:"#666",marginBottom:6},children:r.email})]})]}),e.jsx(k,{events:s}),e.jsxs("div",{style:{marginBottom:32},children:[e.jsx("h3",{children:"Book New Appointment"}),e.jsxs("form",{onSubmit:n,children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("label",{children:"Date:"}),e.jsx("input",{type:"date",value:i.date,onChange:t=>l({...i,date:t.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #ccc"},required:!0})]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("label",{children:"Time:"}),e.jsxs("select",{value:i.time,onChange:t=>l({...i,time:t.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #ccc"},required:!0,children:[e.jsx("option",{value:"",children:"Select time"}),e.jsx("option",{value:"09:00",children:"9:00 AM"}),e.jsx("option",{value:"10:00",children:"10:00 AM"}),e.jsx("option",{value:"11:00",children:"11:00 AM"}),e.jsx("option",{value:"12:00",children:"12:00 PM"}),e.jsx("option",{value:"13:00",children:"1:00 PM"}),e.jsx("option",{value:"14:00",children:"2:00 PM"}),e.jsx("option",{value:"15:00",children:"3:00 PM"}),e.jsx("option",{value:"16:00",children:"4:00 PM"})]})]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("label",{children:"Service:"}),e.jsxs("select",{value:i.service,onChange:t=>l({...i,service:t.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #ccc"},required:!0,children:[e.jsx("option",{value:"",children:"Select service"}),e.jsx("option",{value:"workflow-automation",children:"Workflow Automation"}),e.jsx("option",{value:"data-processing",children:"Data Processing"}),e.jsx("option",{value:"security-services",children:"Security Services"}),e.jsx("option",{value:"sales-marketing",children:"Sales & Marketing"}),e.jsx("option",{value:"quality-management",children:"Quality Management"}),e.jsx("option",{value:"mobile-solutions",children:"Mobile Solutions"}),e.jsx("option",{value:"consultation",children:"General Consultation"}),e.jsx("option",{value:"implementation",children:"Implementation"}),e.jsx("option",{value:"support",children:"Technical Support"}),e.jsx("option",{value:"training",children:"Training"})]})]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("label",{children:"Message:"}),e.jsx("textarea",{value:i.message,onChange:t=>l({...i,message:t.target.value}),placeholder:"Describe your requirements...",style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #ccc",minHeight:80}})]}),v&&e.jsx("div",{style:{color:"red",marginBottom:10},children:v}),h&&e.jsx("div",{style:{color:"green",marginBottom:10},children:h}),e.jsx("button",{type:"submit",disabled:m,style:{padding:"8px 20px",borderRadius:8,background:"#28a745",color:"#fff",border:"none",fontWeight:600},children:m?"Booking...":"Book Appointment"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{children:"My Appointments"}),m?e.jsx("div",{children:"Loading appointments..."}):o.length===0?e.jsx("div",{style:{color:"#666",textAlign:"center",padding:20},children:"No appointments yet"}):e.jsx("div",{style:{maxHeight:200,overflow:"auto"},children:o.map((t,d)=>e.jsxs("div",{style:{border:"1px solid #eee",borderRadius:8,padding:12,marginBottom:8,background:t.status==="confirmed"?"#d4edda":"#fff3cd"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Date:"})," ",t.preferredDate]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Time:"})," ",t.preferredTime]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Service:"})," ",t.service]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"})," ",t.status]}),t.message&&e.jsxs("div",{children:[e.jsx("strong",{children:"Message:"})," ",t.message]})]},d))})]})]}):e.jsx("div",{style:{padding:40,textAlign:"center"},children:"Loading profile..."})}export{A as default};
